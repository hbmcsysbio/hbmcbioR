library(hbmcbioR)
q()
install.packages("~/lib/Rpkg/hbmcbioR.tar.gz", repos = NULL, type = "source")
?readDNAStringSet
library(Biostring)
library(Biostrings)
readDNAStringSet("/wrk/yuanzhen/figureone/A12_12_ATI5_ARAR_5__101n.gz",seqtype = "DNA")
test <- readDNAStringSet("/wrk/yuanzhen/figureone/A12_12_ATI5_ARAR_5__101n.gz")
?DNAStringSet
test <- readr::read_file("/wrk/yuanzhen/figureone/A12_12_ATI5_ARAR_5__101n.gz")
test
library(hbmcbioR)
library(hbmcbioR)
source("~/lib/Rpkg/hbmcbioR/R/motif_html.R", echo=TRUE)
library(hbmcbioR)
devtools::document()
rm(list = c("addmotifLogorow", "da_sim", "motif_database_html"))
devtools::document()
devtools::document()
source("~/lib/Rpkg/hbmcbioR/R/motif_html.R", echo=TRUE)
library(hbmcbioR)
devtools::load_all(".")
rm(list = c("addmotifLogorow", "da_sim", "motif_database_html"))
devtools::load_all(".")
document()
devtools::document()
devtools::build()
install(".")
devtools::install(".")
library(hbmcbioR)
devtools::load_all(".")
library(hbmcbioR)
?hbmcbioR::plotEnrich
devtools::document()
?hbmcbioR::motif_database_html
library(hbmcbioR)
?hbmcbioR::motif_database_html
library(hbmcbioR)
devtools::load_all(".")
library(hbmcbioR)
setdwd("R")
setwd("R")
devtools::load_all(".")
library(hbmcbioR)
devtools::load_all("~/lib/Rpkg/hbmcbioR")
library(hbmcbioR)
devtools::load_all("~/lib/Rpkg/hbmcbioR")
library(hbmcbioR)
library(hbmcbioR)
library(hbmcbioR)
devtools::document()
library(hbmcbioR)
?hbmcbioR::motif_database_html
hbmcbioR::motif_database_html("ARCGTTS",n=8,by="consensus")
library(hbmcbioR)
devtools::document()
library(hbmcbioR)
?hbmcbioR::info_filter
motifs <- readRDS("/wrk/zhu/test/motif_curation/curated_30N_motif_20211014.rds")
pwmlist <- PWMatrixList()
for(f in 1:length(motifs)){
pwmlist[[f]] <- convert_motifs(motifs[[f]], class = "TFBSTools-PWMatrix")
}
sample_info <- read_excel("/wrk/yuanzhen/all_ati/rati.xlsx")
info_filter(sample_info,pwmlist,30,by="ligand",filtername=c("30n","101n"))
source("~/lib/Rpkg/hbmcbioR/R/drewplot.R", echo=TRUE)
devtools::document()
devtools::document()
library(hbmcbioR)
MulticoreParam
??MulticoreParam
library(hbmcbioR)
hbmcbioR:::info_filter(sample_info,pwmlist,30,by="ligand",filtername=c("30n","101n"))
hbmcbioR::info_filter(sample_info,pwmlist,30,by="ligand",filtername=c("30n","101n"))
motifs <- readRDS("/wrk/zhu/test/motif_curation/curated_30N_motif_20211014.rds")
pwmlist <- PWMatrixList()
for(f in 1:length(motifs)){
pwmlist[[f]] <- convert_motifs(motifs[[f]], class = "TFBSTools-PWMatrix")
}
sample_info <- read_excel("/wrk/yuanzhen/all_ati/rati.xlsx")
hbmcbioR::info_filter(sample_info,pwmlist,30,by="ligand",filtername=c("30n","101n"))
?colSums
sample_info$file
library(hbmcbioR)
motifs <- readRDS("/wrk/zhu/test/motif_curation/curated_30N_motif_20211014.rds")
pwmlist <- PWMatrixList()
for(f in 1:length(motifs)){
pwmlist[[f]] <- convert_motifs(motifs[[f]], class = "TFBSTools-PWMatrix")
}
sample_info <- read_excel("/wrk/yuanzhen/all_ati/rati.xlsx")
hbmcbioR::info_filter(sample_info,pwmlist,30,by="ligand",filtername=c("30n","101n"))
library(hbmcbioR)
motifs <- readRDS("/wrk/zhu/test/motif_curation/curated_30N_motif_20211014.rds")
pwmlist <- PWMatrixList()
pwmlist <- PWMatrixList()
for(f in 1:length(motifs)){
pwmlist[[f]] <- convert_motifs(motifs[[f]], class = "TFBSTools-PWMatrix")
}
sample_info <- read_excel("/wrk/yuanzhen/all_ati/rati.xlsx")
hbmcbioR::info_filter(sample_info,pwmlist,30,by="ligand",filtername=c("30n","101n"))
setwd("~")
hbmcbioR::info_filter(sample_info,pwmlist,30,by="ligand",filtername=c("30n","101n"))
?convert_motifs
create_motif()
?create_motif
?sink
?DT::saveWidget
a <- "ACTTRC"
a
str(a)
c <- CCFFSG
?create_motif
hbmcbioR::motif_database_html
myhtml <- hbmcbioR::motif_database_html(pcm=pcm,n=n,by="consensus")
myhtml <- hbmcbioR::motif_database_html(pcm="ACGTTC",n=n,by="consensus")
myhtml <- hbmcbioR::motif_database_html(pcm="ACGTTC",n=10,by="consensus")
myhtml
DT::saveWidget(myhtml,html)
DT::saveWidget(myhtml,"html")
DT::saveWidget(myhtml,"html.html")
debugSource("~/lib/Rpkg/hbmcbioR/R/motif_html.R", echo=TRUE)
motif_database_html(pcm="AATTCGRY",n=10,by="consensus")
x_n
name_
dtlogo
ge
View(ge)
dtlogo
ge <- unique(ge)
View(ge)
write_rds(ge,"/wrk/yuanzhen/motifdb/motif_gene.Rds")
motif_database_html(pcm="AATTCGRY",n=10,by="consensus")
dtlogo
View(ge)
motif_database_html(pcm="AATTCGRY",n=10,by="consensus")
name
name
x_n
library(hbmcbioR)
source("~/lib/Rpkg/hbmcbioR/R/yz_motif_enrich_fjEdit202111.R", echo=TRUE)
pwmlist="/wrk/zhu/test/motif_curation/curated_30N_motif_pwmlist_20211014.rds" %>% readRDS()
motif_get_name(pwmlist[[1]])
pwmlist <- readRDS("/wrk/zhu/test/motif_curation/curated_30N_motif_pwmlist_20211014.rds")
seqs="/wrk/wenchenjin/work/Chenjin1_1__ATI_ara.cell_1/pre_processed/cleaned/B8_20_Mock__root__conc_0nM__time_2h__30n.gz"
tt= plot_motif_enrichment(seqs,pwmlist)
tt
ggplotGrob
tt
debugSource("~/lib/Rpkg/hbmcbioR/R/yz_motif_enrich_fjEdit202111.R", echo=TRUE)
tt= plot_motif_enrichment(seqs,pwmlist)
tt
?eval
parse
?parse
fil <- tempfile(fileext = ".Rdmped")
fil
cat("x <- c(1, 4)\n  x ^ 3 -10 ; outer(1:7, 5:9)\n", file = fil)
parse(file = fil, n = 3)
unlink(fil)
source("~/lib/Rpkg/hbmcbioR/R/yz_motif_enrich_fjEdit202111.R", echo=TRUE)
pwmlist <- readRDS("/wrk/zhu/test/motif_curation/curated_30N_motif_pwmlist_20211014.rds")
seqs="/wrk/wenchenjin/work/Chenjin1_1__ATI_ara.cell_1/pre_processed/cleaned/B8_20_Mock__root__conc_0nM__time_2h__30n.gz"
tt= plot_motif_enrichment(seqs,pwmlist)
library(tidyverse)
tt= plot_motif_enrichment(seqs,pwmlist)
tt
debugSource("~/lib/Rpkg/hbmcbioR/R/motif_html.R", echo=TRUE)
debugSource("~/lib/Rpkg/hbmcbioR/R/motif_html.R", echo=TRUE)
motif_database_html("ACDFDF",by="consensus")
motif_database_html("ACDFDF",by="consensus")
library(hbmcbioR)
motif_database_html("ACDFDF",by="consensus")
motif_database_html("ACCCGc",by="consensus")
motif_database_html("ACCCGC",by="consensus")
library(hbmcbioR)
library(universalmotif)
library(tidyverse)
library(TFBSTools)
dt <- data.frame(x=c(1,2,3,4),motif=c(C,A,D,T))
dt <- data.frame(x=c(1,2,3,4),motif=c("C","A","D","T"))
dt
write_csv(dt,"test")
write_csv(dt,"test",seq=" ")
write_csv(dt,"test",seq="")
write_csv(dt,"test",seq=",")
?write_csv
write_delim(dt,"test.csv")
DECIPHER
fjComm::revComp
?create_motif
mat <- matrix(c(1, 1, 1, 1,
2, 0, 2, 0,
0, 2, 0, 2,
0, 0, 0, 0),
nrow = 4, byrow = TRUE)
mat
create_motif(mat)
create_motif(mat,alphabet = "DNA")
create_motif("CGGTTCG",alphabet = "DNA")
library(hbmcbioR)
mat
test <- "A 1 2 3 4 5 6 6 C 1 2 3 4 5 6 7 G 1 2 3 4 5 6 7 T 1 2 3 4 5 6 7"
str_detect(test,"A")
test
which("c")
which("C")
test %>% which("C")
which()
?which
which(test="C")
create_motif()
?create_motif
mat <- matrix(c(1, 1, 1, 1,
2, 0, 2, 0,
0, 2, 0, 2,
0, 0, 0, 0),
nrow = 4, byrow = TRUE)
mat
DNA.motif <- create_motif(mat, alphabet = "DNA")
DNA.motif
test <- "13 12 12 12 12 12 12； 1 222 33 34 5 6 6； 2 3 444 335 36 7 8； 1 222 3 4 5 6 27"
str_detect(test,";")
str_detect(test,";")
test <- "13 12 12 12 12 12 12; 1 222 33 34 5 6 6; 2 3 444 335 36 7 8; 1 222 3 4 5 6 27"
str_detect(test,";")
str_split(test,";")
str_split(test,";") %>% unlist()
str_split(test,";") %>% unlist() %>% as.matrix()
str_split(test,";") %>% unlist() %>% cbind() %>% as.matrix()
str_split(test,";") %>% unlist() %>% as.matrix()
str_split(test,";") %>% unlist() %>% as.numeric() %>% as.matrix()
str_split(test,";") %>% unlist() %>% as.matrix()
str_split(test,";") %>% as.matrix()
str_split(test,";")
str_split(test,";") %>% unlist()
str_split(test,";") %>% unlist() %>% as.numeric()
str_split(test,";")
str_split(test,";") %>% str_split(" ")
x <- str_split(test,";")
x
x[[1]]
x <- str_split(test," ")
x
str_remove(test,";")
str_remove(test,";")
str_remove(test,"[0-9]")
str_detect(test,"[0-9]")
str_detect(test,"[0-9]+")
test = "34"
str_detect(test,"[0-9]+")
str_detect(test,"[0-9]")
str_detect(test,"[0-9]+")
test <- "12 12 12 12 33; 12 1 1 1 1; 34 12 12 13 14; 12 14 56 78 23"
test
test <- "12 12 12 12 33; 12 1 1 1 1; 34 12 12 13 14; 12 14 56 78 23"
str_split(test,";")
str_split(test,";") %>% unlink()
str_split(test,";") %>% unlist()
str_split(test,";") %>% unlist() %>% as.matrix()
x <- str_split(test,";") %>% unlist() %>% as.data.frame()
x
x <- str_split(test,";") %>% unlist() %>% as.data.frame(stringAsFactors=F)
x
x[1]
x[1,1]
x[1,1] %>% as.numeric()
x[1,1] %>% str_split(" ") %>% as.numeric()
x[1,1] %>% str_split(" ")
x[1,1] %>% str_split(" ") %>% unlist
x[1,1] %>% str_split(" ") %>% unlist() %>% as.numeric()
x_ <- str_split(test,";") %>% unlist() %>% as.data.frame(stringAsFactors=F)
x_
numr <- mapply(x_,functions(x){str_split(x," ") %>% unlist() %>% as.numeric()})
numr <- apply(x_,functions(x){str_split(x," ") %>% unlist() %>% as.numeric()})
numr <- sapply(x_,functions(x){str_split(x," ") %>% unlist() %>% as.numeric()})
numr <- lapply(x_,functions(x){str_split(x," ") %>% unlist() %>% as.numeric()})
x_
numr <- apply(x_,function(x){str_split(x," ") %>% unlist() %>% as.numeric()})
numr <- apply(x_,function(x)str_split(x," ") %>% unlist() %>% as.numeric())
numr <- apply(x_,FUN=function(x)str_split(x," ") %>% unlist() %>% as.numeric())
numr <- apply(x_,1,FUN=function(x)str_split(x," ") %>% unlist() %>% as.numeric())
numr
numr <- apply(x_,1,FUN=function(x)str_split(x," ") %>% unlist() %>% as.numeric() %>% na.omit())
numr
x
create_motif(numr, alphabet = "DNA")
mat
numr_m <- as.matrix(numr)
numr_m
str(numr_m)
create_motif(numr_m, alphabet = "DNA")
numr <- apply(x_,1,FUN=function(x)str_split(x," ") %>% unlist() %>% as.numeric())
numr
numr %>% unlist()
tc <- c(1,1,1,1,1)
tc
numr %>% unlist() %>% na.omit()
numr %>% unlist()
numr <- apply(x_,1,FUN=function(x)str_split(x," ") %>% unlist() %>% as.numeric() %>% unlist)
numr
numr <- sapply(x_,1,FUN=function(x)str_split(x," ") %>% unlist() %>% as.numeric())
numr <- apply(x_,1,FUN=function(x)str_split(x," ") %>% unlist() %>% as.numeric())
numr
numr <- numr %>% unlist()
numr
is.na(numr)
numr <- numr[!is.na(numr)]
numr
mat <- matrix(numr,nrow = 4,byrow = TRUE)
mat
create_motif(mat, alphabet = "DNA")
view_motifs(create_motif(mat, alphabet = "DNA"))
test
pcm=test
pcm
if(str_detect(pcm,";")){
x_ <- str_split(pcm,";") %>% unlist() %>% as.data.frame(stringAsFactors=F)
numr <- apply(x_,1,FUN=function(x)str_split(x," ") %>% unlist() %>% as.numeric())
numr <- numr %>% unlist()
numr <- numr[!is.na(numr)]
mat <- matrix(numr,nrow = 4,byrow = TRUE)
pcm=mat
}else{
pcm=pcm
}
pcm
pcm <- universalmotif::create_motif(pcm,name = "your_give_consensus",alphabet = "DNA")
pcm
?DECIPHER::AlignSeqs
db <- system.file("extdata", "Bacteria_175seqs.sqlite", package="DECIPHER")
dna <- SearchDB(db, remove="all")
alignedDNA <- AlignSeqs(dna)
BrowseSeqs(alignedDNA, highlight=1)
source("/wrk/zhu/test/align_AA/test.R")
library(ShortRead)
readFasta("ATMYB2_orthologues.fa")
seqs=readFasta("ATMYB2_orthologues.fa")
seqs
seqs=readFasta("ATMYB2_orthologues.fa") %>% DNAStringSet()
methods(class = class(seqs))
seqs=readFasta("ATMYB2_orthologues.fa") %>% sread
seqs=readFasta("ATMYB2_orthologues.fa") %>% sread
DECIPHER::AlignSeqs(seqs)
align=DECIPHER::AlignSeqs(seqs)
DECIPHER::BrowseSeqs(align)
fjComm::align_AA_DBD
fjComm::align_AA
seqs=readFasta("ATMYB2_orthologues.fa") %>% sread %>% as.character()
fjComm::align_AA(seqs)
?DNAMultipleAlignment
source("/wrk/zhu/test/align_AA/test.R")
plot=DNAMultipleAlignment(align)
plot
msaPrettyPrint(plot,output = "pdf")
DECIPHER::BrowseSeqs(align)
plot=DNAMultipleAlignment(align)
msaPrettyPrint(plot,output = "tex")
msaPrettyPrint(plot,output = "pdx")
msaPrettyPrint(plot,output = "dvi")
source("/wrk/zhu/test/align_AA/test.R")
msa::msaPrettyPrint(plot,output = "dvi")
msa::msaPrettyPrint(plot,output = "dvi")
DECIPHER::BrowseSeqs(align)
library(ShortRead,Biostrings)
library(ShortRead,Biostrings)
seqs=readFasta("ATMYB2_orthologues.fa") %>% sread
align=DECIPHER::AlignSeqs(seqs)
source("/wrk/zhu/test/align_AA/test.R")
library(ShortRead,Biostrings,hbmcbioR)
seqs=readFasta("ATMYB2_orthologues.fa") %>% sread
source("/wrk/zhu/test/align_AA/test.R")
library(ShortRead,Biostrings,hbmcbioR)
library(ShortRead)
library(ShortRead)
library(Biostrings)
library(hbmcbioR)
seqs=readFasta("ATMYB2_orthologues.fa") %>% sread
align=DECIPHER::AlignSeqs(seqs)
source("/wrk/zhu/test/align_MYB/align_MYB.R")
library(ShortRead)
library(hbmcbioR)
source("/wrk/zhu/test/align_MYB/align_MYB.R")
source("/wrk/zhu/test/align_MYB/align_MYB.R")
seqs
seqs=sread(readFasta("ATMYB2_orthologues.fa"))
seqs
align_myb=DECIPHER::AlignSeqs(seqs)
DECIPHER::BrowseSeqs(align_myb)
pacman::p_load(msa)
?msa::msa
Vinette
Vignette(msa)
Vignette(Biostrings)
vignette(msa)
vignette("TFBSTools")
vignette("TFBSTools")
wrky_ex <- read_rds("/wrk/yuanzhen/atacseq/wrky_ex")
camta_ex <- read_rds("/wrk/yuanzhen/atacseq/camta_ex")
??read_rds
library(readr)
wrky_ex <- read_rds("/wrk/yuanzhen/atacseq/wrky_ex")
camta_ex <- read_rds("/wrk/yuanzhen/atacseq/camta_ex")
View(camta_ex)
View(wrky_ex)
gene_total_ex <- read_rds("/wrk/yuanzhen/atacseq/gene_totak_ex")
View(gene_total_ex)
wrky <- read_delim("atacseq/wrky.txt", "\t",escape_double = FALSE, trim_ws = TRUE)
camta <- read_delim("atacseq/camta.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
wrky <- read_delim("/wrk/yuanzhen/atacseq/wrky.txt", "\t",escape_double = FALSE, trim_ws = TRUE)
camta <- read_delim("/wrk/yuanzhen/atacseq/camta.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
View(camta)
View(wrky)
View(gene_total_ex)
top
View(gene_total_ex)
fjComm::ggheat(gene_total_ex)
library(fjComm)
fjComm::ggheat(gene_total_ex)
fjComm::ggheat(gene_total_ex %>% as.matrix())
library(magrittr)
fjComm::ggheat(gene_total_ex %>% as.matrix())
gene_total_ex %>% as.matrix() %>% gg_hist()
heatmap(gene_total_ex %>% as.matrix())
heatmap(gene_total_ex %>% sort(desc(dmso1)) %>%  as.matrix())
heatmap(gene_total_ex %>% arrange(desc(dmso1)) %>%  as.matrix())
heatmap(gene_total_ex %>% arrange(desc(dmso1)) %>%  as.matrix(),Rowv = NA)
View(wrky)
View(camta)
View(camta_ex)
gene_total_ex %>% dplyr::filter(rownames(gene_total_ex) %in% camta$`Locus ID`)
gene_total_ex %>% dplyr::select(rownames(gene_total_ex) %in% camta$`Locus ID`)
gene_total_ex %>% dplyr::filter(rownames(gene_total_ex) %in% camta$`Locus ID`)
camta$`Locus ID`
rownames(gene_total_ex)
gene_total_ex %>% dplyr::filter(rownames(gene_total_ex) %in% (camta$`Locus ID` %>% toupper()))
View(camta)
gene_total_ex[match(rownames(gene_total_ex),camta$`Locus ID` %>% toupper())]
gene_total_ex[match(rownames(gene_total_ex),camta$`Locus ID` %>% toupper()),]
gene_total_ex[match(camta$`Locus ID` %>% toupper(),rownames(gene_total_ex)),]
gene_total_ex[match(camta$`Locus ID` %>% toupper(),rownames(gene_total_ex)),] %>% melt()
gene_total_ex[match(camta$`Locus ID` %>% toupper(),rownames(gene_total_ex)),] %>% rownames_to_column()
cbind(camta, gene_total_ex[match(camta$`Locus ID` %>% toupper(),rownames(gene_total_ex)),] %>% rownames_to_column())
camta_ex=cbind(camta, gene_total_ex[match(camta$`Locus ID` %>% toupper(),rownames(gene_total_ex)),] %>% rownames_to_column())
View(camta_ex)
setwd("/wrk/zhu/analysis/2021_APTI/ISAC_202111/")
saveRDS(camta_ex,"root_RNA_seq/data/camta_expressions")
saveRDS(gene_total_ex,"root_RNA_seq/data/gene_total_expressions.rds")
wrky_ex=cbind(wrky, gene_total_ex[match(wrky$`Locus ID` %>% toupper(),rownames(gene_total_ex)),] %>% rownames_to_column())
View(wrky_ex)
saveRDS(wrky_ex,"root_RNA_seq/data/wrky_expressions")
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
View(camta_ex)
camta_ex[,6:9]
camta_ex[,6:9] %>% as.matrix() %>% ggheat()
(camta_ex[,6:9] %>% as.matrix() %>% ggheat())+scale_fill_gradientn(colours = gg_steelblue_red)
(camta_ex[,6:9] %>% as.matrix() %>% ggheat(labCol = qw("DMSO1 DMSO2 IAA1 IAA2")))+scale_fill_gradientn(colours = gg_steelblue_red)
(camta_ex[,6:9] %>% as.matrix() %>% ggheat(labCol = qw("DMSO1 DMSO2 IAA1 IAA2")))+scale_fill_gradientn(colours = gg_steelblue_red)
(camta_ex[,6:9] %>% as.matrix() %>% ggheat(labCol = qw("DMSO1 DMSO2 IAA1 IAA2")))+scale_fill_gradientn(colours = gg_steelblue_red)
(camta_ex[,6:9] %>% as.matrix() %>% ggheat(labCol = qw("DMSO1 DMSO2 IAA1 IAA2")))
(camta_ex[,6:9] %>% as.matrix() %>% ggheat())+scale_fill_gradientn(colours = gg_steelblue_red)
ggheat()
ggheat
(camta_ex[,6:9] %>% as.matrix() %>% ggheat(clustering = "row")+scale_fill_gradientn(colours = gg_steelblue_red)
(camta_ex[,6:9] %>% as.matrix() %>% ggheat(clustering = "row"))+scale_fill_gradientn(colours = gg_steelblue_red)
(camta_ex[,6:9] %>% as.matrix() %>% ggheat(clustering = "row"))+scale_fill_gradientn(colours = gg_steelblue_red)
camta_ex[,6:9] %>% as.matrix()
camta_ex[,6:9] %>% as.matrix() %>% set_rownames(camta_ex$`Gene/Protein Name`)
(camta_ex[,6:9] %>% as.matrix() %>% set_rownames(camta_ex$`Gene/Protein Name`) %>% ggheat(clustering = "row"))+scale_fill_gradientn(colours = gg_steelblue_red)
gg_steelblue_red
(camta_ex[,6:9] %>% as.matrix() %>% set_rownames(camta_ex$`Gene/Protein Name`) %>% ggheat(clustering = "row"))+scale_fill_gradientn(colours = gg_steelblue_red,limits=c(0,2000))
camta_ex[,6:9] %>% max()
(camta_ex[,6:9] %>% as.matrix() %>% set_rownames(camta_ex$`Gene/Protein Name`) %>% ggheat(clustering = "row"))+
scale_fill_gradientn(colours = gg_steelblue_red,limits=c(0,camta_ex[,6:9] %>% max()))
gg_heat
gg_heat()
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
ggheat
camta_ex[,6:9] %>% colnames()
(camta_ex[,6:9] %>% as.matrix() %>% set_rownames(camta_ex$`Gene/Protein Name`) %>% ggheat(clustering = "row"))+
scale_fill_gradientn(colours = gg_steelblue_red,limits=c(0,camta_ex[,6:9] %>% max()))+scale_x_continuous(expand = c(0,0),labels =camta_ex[,6:9] %>% colnames() )
(camta_ex[,6:9] %>% as.matrix() %>% set_rownames(camta_ex$`Gene/Protein Name`) %>% ggheat(clustering = "row"))
ggheat
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
m
colnames(m)
m
melt.m
g2
melt.m$Var2
melt.m
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
(camta_ex[,6:9] %>% as.matrix() %>% set_rownames(camta_ex$`Gene/Protein Name`) %>% ggheat(clustering = "row"))+
scale_fill_gradientn(colours = gg_steelblue_red,limits=c(0,camta_ex[,6:9] %>% max()))+scale_x_continuous(expand = c(0,0),labels =camta_ex[,6:9] %>% colnames() )
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
(camta_ex[,6:9] %>% as.matrix() %>% set_rownames(camta_ex$`Gene/Protein Name`) %>% ggheat(clustering = "row"))+
scale_fill_gradientn(colours = gg_steelblue_red,limits=c(0,camta_ex[,6:9] %>% max()))+scale_x_continuous(expand = c(0,0),labels =camta_ex[,6:9] %>% colnames() )
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
g2
g2+scale_x_continuous(breaks=(1:cols)-0.5, labels=colnames(m))
g2+scale_y_continuous(breaks=(1:rows)-0.5, labels=rownames(m),expand = c(0,0))
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
(camta_ex[,6:9] %>% as.matrix() %>% set_rownames(camta_ex$`Gene/Protein Name`) %>% ggheat(clustering = "row"))+
scale_fill_gradientn(colours = gg_steelblue_red,limits=c(0,camta_ex[,6:9] %>% max()))
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
source("/wrk/zhu/analysis/2021_APTI/ISAC_202111/root_RNA_seq/expression_levels.R")
